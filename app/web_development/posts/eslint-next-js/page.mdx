%toc%

<article>

# ESLint

## Next.js ESLint packages

before we get started, I want to make you aware of something

> [!NOTE]  
> Next.js has **2 packages** that are related to ESLint, one is called eslint-**config**-next and the other one is called eslint-**plugin**-next

- [eslint-config-next](https://www.npmjs.com/package/eslint-config-next)
- [eslint-plugin-next](https://www.npmjs.com/package/@next/eslint-plugin-next)

Package 1: **eslint-config-next** intends to make it easier to get started with ESLint by bundling multiple plugins, as of now (november 2003) it will install and configure the following 3 plugins for you:

- [eslint-plugin-react](https://www.npmjs.com/package/eslint-plugin-react)
- [eslint-plugin-react-hooks](https://www.npmjs.com/package/eslint-plugin-react-hooks)
- [eslint-plugin-next](https://www.npmjs.com/package/@next/eslint-plugin-next)

Package 2: **eslint-plugin-next** is the actual ESLint plugin for Nextjs (called **@next/eslint-plugin-next** on npmjs), it aims to catch common issues and problems in a Nextjs application

for a full list of rules that the Next.js ESLint plugin will add check out the [Nextjs "ESLint rules" documentation](https://nextjs.org/docs/app/building-your-application/configuring/eslint#eslint-plugin) or have a look at the [eslint-plugin-next rules directory on github](https://github.com/vercel/next.js/tree/canary/packages/eslint-plugin-next/src/rules)

## 4 options to add ESLint to your Next.js project

I will describe 4 ways to add ESLint to a Next.js project

> [!NOTE]  
> the first option is by far the fastest to set up and the one that will require the least amount of maintenance (which matters to keep the technilogical dept of your project low) but on the other hand it is the one that is the least customizable, the last one is most time consuming but also most customizable

- option 1: you use [create-next-app](https://www.npmjs.com/package/create-next-app) and when asked about installing eslint you select **YES** to install ESLint
- option 2: you use **create-next-app** but when asked about installing ESLint you select **NO**, then later you use the Next.js cli linting script via the command `npm run lint{:shell}` (which will install eslint if you did not already install it manully)
- option 3: we will NOT use **create-next-app** at all, instead we will manually create an ESLint configuration file and install **eslint-config-next** manually, which will automatically install the 3 plugins (eslint-plugin-react, eslint-plugin-react-hooks and eslint-plugin-next) for us
- option 4: we will do a fully manual installation of everything needed to lint both our code and MDX content (we will include **eslint-plugin-next**, but we will NOT use **create-next-app** or the **eslint-config-next** package)

### option 1

the first thing we are about to do is use the [create-next-app](https://nextjs.org/docs/pages/api-reference/create-next-app) package to initialize a new Next.js project, this tool is similar to what [create-react-app](https://create-react-app.dev/) does for React, using this tool to setup a Next.js project will save you a lot of time and it adds a lot of useful dependencies (needed for a Next.js project) to your stack and also adds a default configuration for each of them so that you can start coding right away

> [!NOTE]  
> if you have a already a Next.js project, then you can still use **create-next-app**, just create another blank project (using create-next-app) next to your main project, then look at what create-next-app did, for example what dependencies did it add to the package.json file, how did it setup ESLint for me, what is inside the default next.config.js or tsconfig.json files and copy past those parts you are interested in, into your existing project to upgrade it

first we use the following command in our VSCode terminal (or any other command line tool you prefer) to run create-next-app:

```shell
npx create-next-app@latest
```

when the create-next-app installation process aks us the following question:

> Would you like to use ESLint?

this time we choose **YES**

**create-next-app** will install eslint as well as the **eslint-config-next** package for us (both get added to the devDependencies in the package.json), as seen above in the ["Next.js ESLint packages" chapter](#nextjs-eslint-packages) eslint-config-next will install the 3 plugins **eslint-plugin-react**, **eslint-plugin-react-hooks** and **eslint-plugin-next** for us

**create-next-app** will also create an `.eslintrc.json` file in the root of the project, create-next-app will automatically use the "strict" (it is the default mode when using create next app, you can not chose the mode yourself), in strict next/core-web-vitals gets extended in the eslintrc configuration file, **next/core-web-vitals** is a set of extra rules intended to warn you about potential optimizations you can do that are related to core web vitals metrics, like rules to improve page loading speed

finally **create-next-app** will also add the line `"lint": "next lint"{:json}` to your package.json `scripts`, which means that you now can use the command `npm run lint{:shell}`, which will execute `next lint`, next lint is the Nextjs cli command for linting

this is already it, Next.js and code linting are ready to be used with almost no effort from your side and you can be sure that the create-next-app script has created a solid linting solution because it was built using the collective knowledge of all the devs contributing to Next.js

> [!MORE]  
> - [create-next-app](https://nextjs.org/docs/pages/api-reference/create-next-app)

### option 2

- use the following command `npx create-next-app@latest` to run create-next-app
- when you get asked "Would you like to use ESLint?" choose "NO"
- even if you choose to NOT install ESLint via create-next-app, it will still add the following line `"lint": "next lint"` to your package.json `scripts`, which means that if you now can use the command `npm run lint` it will execute `next lint` which is the nextjs cli command for linting because it is the first time you run this command and it can't find an eslint configuration file it will suggest you create one
- when using npm run lint, you will get asked if you want to use the **strict** mode (which includes the "core web vitals" rule-set) or the **base** eslint rule-sets, after that **eslint** and **eslint-config-next** will get installed for you
- the script should also create an eslintrc file for you, but currently (16.10.2023) doesn't due to a bug: [Nextjs GitHub issue #55102 (next eslint .eslintrc.json file not being created)](https://github.com/vercel/next.js/issues/55102)

### option 3

- run the following command to install **eslint-config-next** manually `npm i eslint eslint-config-next --save-dev --save-exact`
- now also need to create an `.eslintrc.json` file (if you haven't already created one manually before) in the root of the project
- next, if you wish to use the eslint-config-next **strict** mode (including the "core web vitals" rule-set) add this to your eslint configuration file `"extends": "next/core-web-vitals"` or if you prefer to use the **base** mode add this to your eslint configuration file `"extends": "next"`, make sure the extends for nextjs is always last (after other configurations that you might be have added in your eslint extends)

Note: as mentioned in the [nextjs "configuring ESLint" documentation](https://nextjs.org/docs/pages/building-your-application/configuring/eslint) it is important that **next/core-web-vitals** is last in the list of extended configurations to ensure none of their configurations get overwritten by another configuration that comes after

the package.json will not have a linting command (because we did not use create-next-app), so we need to add the following line `"lint": "next lint"` to our package.json `scripts` to enable linting via the next cli, if we use **next lint** it will lint the default nextjs directories (as of now `ESLINT_DEFAULT_DIRS = ['app', 'pages', 'components', 'lib', 'src']`), but you can manually change that list using the `--dir` flag, to specify which files should get linted you can use the `--file` flag, you can also use the next lint option `--no-cache` to disable caching files into the directory `.next/cache`

### option 4

#### create an eslintrc file

first, we configure ESLint using their configuration tool, using this command:

```shell
npm init @eslint/config
```

chose the options you like best, I for my part chose the following:

- how would you like to use eslint: check syntax, find problems and enforce code style
- what type of modules does your project use: javascript (import/export)
- which framework does your project use: react
- does your project use typescript: yes
- where does your project run: press the "a" key to have both selected, "browser" and "node"
- how would you like to define a style for your project: you can select "use a popular style guide" and eslint will let you choose between ["standard"](https://www.npmjs.com/package/eslint-config-standard-with-typescript) and ["XO"](https://www.npmjs.com/package/eslint-config-xo), check out their repositories if you want to know more about what configuration they apply, I for my part prefer to answer some questions to set my own rules and also because in the next step we will extend the next.js ESLint configuration
- what format do you want your config to be in: I like to use javascript configuration files over json as it allows me to leave comments for myself and other developers that might come after me if I wish to do so, so I chose "javascript"
- what style of indentation do you use: I have always used 4 spaces, so I will stick to this, some prefer 2 spaces others prefer tabs these days, there is no right or wrong here, choose what you like best
- what quotes do you use for strings: I always use single quotes, I don't use double quotes in JS and I reserve them for HTML attributes
- what line endings do you use: I chose Windows as I'm on Windows, I don't think it doesn't matter much, because when you commit to GitHub they will get converted anyway, ["for compatibility, line endings are converted to Unix style when you commit files"](https://docs.github.com/en/get-started/getting-started-with-git/configuring-git-to-handle-line-endings#about-line-endings), also if you want to know more about line endings I recommend reading this article ["Dealing with line endings in Windows with Git and ESLint"](https://markoskon.com/line-endings-in-vscode-with-git-and-eslint/)
- do you require semicolons: I don't anymore, less to code is a win for me, but I know it can cause problems as there are some places where they are mandatory, like between statements in a **for loop**, but in all these years finding those few exceptions has not been a problem

now eslint init has created a `.eslintrc.js` configuration file for us

#### package.json scripts lint command using **next lint**

when using option 4, the package.json will not have a linting command, because we did not use create-next-app (which adds that command to your package.json scripts for you)

this is why we need to add the following line `"lint": "next lint"` to our package.json `scripts` to enable linting by using the `next lint` command of the next cli

</article>
